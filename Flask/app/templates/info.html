{% extends "base.html" %}
{% block content %}
<h1>{{ title }}</h1>

<div>
    <form action="/dbop" method="POST">
        <div class="form-type">
            <label>类型</label>
            <select name="类型">
                {% if filter[0] %}
                <option value="{{ filter['类型'] }}" selected="selected">{{ filter[0] }}</option>
                <option value="">所有</option>
                {% else %}
                <option value="" selected="selected">所有</option>
                {% endif %}
                <option value="材料">材料</option>
                <option value="设备">设备</option>
            </select>
        </div>
        <div class="form-name">
            <label>名称</label>
            <input type="text" name="名称" value="{{ filter['名称'] }}">
        </div>
        <div class="form-model">
            <label>型号</label>
            <input type="text" name="型号" value="{{ filter['型号'] }}">
        </div>
        <div class="form-id">
            <label>序列号</label>
            <input type="text" name="序列号" value="{{ filter['序列号'] }}">
        </div>
        <div class="form-contract-id">
            <label>合同号</label>
            <input type="text" name="合同号" value="{{ filter['合同号'] }}">
        </div>
        <div class="form-date">
            <label>到货时间</label>
            <input type="date" name="到货时间" value="{{ filter['到货时间'] }}">
        </div>
        <div class="form-manager">
            <label>经办人</label>
            <input type="text" name="经办人" value="{{ filter['经办人'] }}">
        </div>
        <div class="form-status">
            <label>状态</label>
            <select name="状态">
                {% if filter[6] %}
                <option value="{{ filter['状态'] }}" selected="selected">{{ filter['状态'] }}</option>
                <option value="">所有</option>
                {% else %}
                <option value="" selected="selected">所有</option>
                {% endif %}
                <option value="在用">在用</option>
                <option value="待用">待用</option>
                <option value="待维修">待维修</option>
                <option value="维修中">维修中</option>
                <option value="被借">被借</option>
            </select>
        </div>
        <div class="form-location">
            <label>存放位置</label>
            <input type="text" name="存放位置" value="{{ filter['存放位置'] }}">
        </div>
        <div class="form-contract-file">
            <label>合同文件</label>
            <input type="text" name="合同文件" value="">
        </div>
        <div class="form-operation"><input type="submit" name="op" value="筛选"></div>
    </form>
</div>

<div>
    <form action="/dbop" enctype="multipart/form-data" method="POST">
        <td class="form-index">插入</td>
        <td class="form-type">
            <select name="类型">
                <option value="材料" selected="selected">材料</option>
                <option value="设备">设备</option>
            </select>
        </td>
        <td class="form-name"><input type="text" name="名称" value="" required></td>
        <td class="form-model"><input type="text" name="型号" value="" required></td>
        <td class="form-id"><input type="text" name="序列号" value="" required></td>
        <td class="form-contract-id"><input type="text" name="合同号"></td>
        <td class="form-date"><input type="date" name="到货时间"></td>
        <td class="form-manager"><input type="text" name="经办人"></td>
        <td class="form-status">
            <select name="状态">
                <option value="在用" selected="selected">在用</option>
                <option value="待用">待用</option>
                <option value="待维修">待维修</option>
                <option value="维修中">维修中</option>
                <option value="被借">被借</option>
            </select>
        </td>
        <td class="form-location"><input type="text" name="存放位置"></td>
        <td class="form-contract-file"><input type="file" name="合同文件"></td>
        <td class="form-photo"><input type="file" name="照片"></td>
        <td class="form-comment"><input type="text" name="备注"></td>
        <td class="form-operation"><input type="submit" name="op" value="插入"></td>
    </form>
</div>

<div>
    <table id="info">
        <tr id="table-head">
            <th class="info-index">序号</th>
            <th class="info-type">类型</th>
            <th class="info-name">名称</th>
            <th class="info-model">型号</th>
            <th class="info-id">序列号</th>
            <th class="info-contract-id">合同号</th>
            <th class="info-date">到货时间</th>
            <th class="info-manager">经办人</th>
            <th class="info-status">状态</th>
            <th class="info-location">存放位置</th>
            <th class="info-contract-file">合同文件</th>
            <th class="info-photo">照片</th>
            <th class="info-comment">备注</th>
            <th class="info-operation">操作</th>
        </tr>
        {% for record in records %}
        <tr id="record-{{ loop.index }}">
            <td class="info-index">{{ loop.index }}</td>
            <td class="info-type">{{ record[0] }}</td>
            <td class="info-name">{{ record[1] }}</td>
            <td class="info-model">{{ record[2] }}</td>
            <td class="info-id">{{ record[3] }}</td>
            <td class="info-contract-id">{{ record[4] }}</td>
            <td class="info-date">{{ record[5] }}</td>
            <td class="info-manager">{{ record[6] }}</td>
            <td class="info-status">{{ record[7] }}</td>
            <td class="info-location">{{ record[8] }}</td>
            {% if record[8] != 'None' and record[9] %}
            <td class="info-contract-file">
                <a href="{{ record[8] }}">下载</a>
            </td>
            {% else %}
            <td class="info-contract-file">无</td>
            {% endif %}
            <td class="info-photo">{{ record[10] }}</th>
            <td class="info-comment">{{ record[11] }}</th>
            <td class="info-operation">
                <form action="/operate" method="POST">
                    <input type="hidden" name="名称" value="{{ record[1] }}">
                    <input type="hidden" name="型号" value="{{ record[2] }}">
                    <input type="hidden" name="序列号" value="{{ record[3] }}">
                    <input type="submit" name="op" value="删除">
                    <input type="submit" name="op" value="修改">
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}